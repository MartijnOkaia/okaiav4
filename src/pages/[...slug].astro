---

import Layout from '../layouts/Layout.astro';

import { useStoryblokApi } from '@storyblok/astro'
import StoryblokComponent from '@storyblok/astro/StoryblokComponent.astro'
 
export async function getStaticPaths() {
  const storyblokApi = useStoryblokApi()
 
  const { data } = await storyblokApi.get('cdn/links', {
    version: process.env.PUBLIC_ENV !== 'production' ? "draft" : "published"
  })
  let links = data.links

  links = Object.values(links)
  
  return links
  .filter((link) => !link.is_folder)
  .map((link) => {
    return {
      params: {
        slug: link.slug === 'home' ? undefined : link.slug,
      },
      props: {
        other_slug: link.slug === 'home' ? undefined : link.alternates[0].translated_slug,
      }
    }
  })

}
 
const { slug } = Astro.params
const { other_slug } = Astro.props
 
const storyblokApi = useStoryblokApi()
 
const { data } = await storyblokApi.get(
  `cdn/stories/${slug === undefined ? 'home' : slug}`,
  {
    version: process.env.PUBLIC_ENV !== 'production' ? "draft" : "published",
    language: 'nl'
  }
)
 
const story = data.story
---


<Layout title="Okaia - creative digital agency" otherSlug={other_slug}>

    <StoryblokComponent blok={story.content} />
    
</Layout>